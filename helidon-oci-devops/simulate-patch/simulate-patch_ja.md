# パッチ・シナリオのシミュレーション

## 概要

この演習では、パッチ適用シナリオのシミュレートを試みます。初期環境がテストに_Open JDK_を使用し、本番の準備ができたときに最終的に_Oracle JDK_を使用するように移行する場合を考えます。以前のビルドおよびデプロイメント・パイプラインでは、使用するJavaフレーバーとして_Open JDK 20_がすでに設定されています。この演習では、_Oracle JDK 20_に置き換えられます。

所要時間: 10分

ラボのクイック・ウォークスルーについては、次のビデオをご覧ください。[パッチ・シナリオのシミュレート](videohub:1_4pecvhmf)

### 目的

この演習では、次のことを行います。

*   JDKフレーバの変更
*   デプロイメント・パイプラインでのJDKの新しいフレーバの確認

### 前提条件

*   Oracle Free Tier(トライアル)、有料またはLiveLabsクラウド・アカウント

## タスク1: JDKインストーラの変更

1.  **ラボ2**で確認したように、以前に完了した**デプロイメント・パイプライン・ログ**で、ログの下部付近で**Open JDK**を使用していることがわかりました。 ![jdkを開く](images/open-jdk.png)
    
2.  **コード・エディタ**で、ファイル名**`build_spec.yaml`**をクリックして開きます。次に示すように、URLパスを行番号#15で**Open JDK**インストーラに設定し、URLパスを行番号#16で**Oracle JDK**インストーラに設定する**`JDK20_TAR_GZ_INSTALLER`**のコメントを解除する環境変数**`JDK20_TAR_GZ_INSTALLER`**をコメント・アウトします。 ![jdkの変更](images/modify-jdk.png)
    

## タスク2: 変更のプッシュとDevOpsパイプラインのトリガー

1.  次のコマンドをコピーして端末に貼り付け、**変更をコミットしてプッシュ**します。
    
        <copy>git add .
        git status
        git commit -m "Replace OpenJDK 20 with OracleJDK 20"
        git push</copy>
        
    
    > パイプラインはこのgitプッシュによってトリガーされます。
    

## タスク3: デプロイメント・パイプラインでのJDKの新しいフレーバの確認

1.  新しいタブで[クラウド・コンソール](https://cloud.oracle.com/)を開き、_「ハンバーガー・メニュー」_→_「開発者サービス」_→_「プロジェクト」_(**DevOps**の下)をクリックします。 ![devopsプロジェクト](images/devops-project.png)
    
2.  **ラボ1**で作成したコンパートメントを選択し、_「devops-project-helidon-ocw-hol-string」_をクリックして**DevOpsプロジェクト**を開きます。 ![コンパートメントの選択](images/select-compartment.png)
    
3.  **「最新のビルド履歴」**に、**「実行」**および「ステータス」が**「受入れ済/進行中」**と表示されます。次に示すように、最新の実行をクリックします。 ![ビルド履歴](images/build-history.png)
    
4.  ビルド・パイプラインが**3つのステージをすべて完了**すると、次に示すように出力が表示されます。 ![最初にビルド実行](images/build-run-first.png)
    
5.  ビルド実行の進行中、第3ステージで**「3つのドット」**をクリックし、次に示すように**「デプロイメントの表示」**をクリックします。これにより、デプロイメント・パイプラインが開きます。 ![ビュー・デプロイメント](images/view-deployment.png)
    
6.  **「デプロイメントの進行状況」**を参照してください。デプロイメント・パイプラインが完了すると、次に示すように出力が表示されます。 ![デプロイメント実行](images/deployment-run.png)
    
    > これにより、HelidonアプリケーションがOCIのコンピュート・インスタンスに正常にデプロイされます。
    
7.  デプロイメント・パイプラインのログを表示するには、デプロイメント・ステージの近くにある**3つのドット**をクリックし、次に示すように**「詳細の表示」**をクリックします。 ![ログの表示](images/view-logs.png)
    
8.  ログを下にスクロールし、JDKフレーバを確認します。次に示すように、**Oracle JDK**である必要があります。 ![オラクルjdk](images/oracle-jdk.png)
    

**次の演習に進みます。**

## 確認

*   **著者** - Keith Lustria
*   **貢献者** - Ankit Pandey、Maciej Gruszka
*   **最終更新者/日付** - Ankit Pandey、2023年8月
# コンピュート・インスタンスの設定

## 概要

このラボでは、ワークショップの実行に必要なOracle Cloudオブジェクトを生成する**Oracle WebLogic Suite for OKE BYOL**スタックを設定する方法について説明します。

見積時間: 15分

### 目的

この演習では、次のことを行います。

*   認証トークンを生成します。
*   Vaultでのシークレットの作成
*   スタックの作成: Oracle WebLogic Suite for OKE BYOL
*   コンピュート・インスタンスに接続

### 事前設定

この演習では、次を想定しています。

*   Oracle Cloudアカウント
*   SSHキーのペアを生成しました。
*   完了: **ラボ: 設定の準備**

## タスク1: 認証トークンの生成

このタスクでは、_認証トークン_を生成します。演習5では、この認証トークンを使用して補助イメージをOracle Cloud Container Registryリポジトリにプッシュします。また、この認証トークンを使用して、WebLogic dockerイメージをOracle Cloud Infrastructure Registry (コンテナ・レジストリとも呼ばれる)にプルします。

1.  右上隅にある「ユーザー・アイコン」を選択し、_MyProfile_を選択します。
    
    ![自分のプロファイル](images/my-profile.png)
    
2.  下にスクロールして_「認証トークン」_を選択し、_「トークンの生成」_をクリックします。
    
    ![認証トークン](images/auth-token.png)
    
3.  _`test-model-your_first_name`_をコピーして_「説明」_ボックスに貼り付け、_「トークンの生成」_をクリックします。
    
    ![トークンの作成](images/create-token.png)
    
4.  「生成済トークン」の下の_「コピー」_を選択し、テキスト・ファイルに貼り付けます。後でコピーできません。_「閉じる」_をクリックします。
    
    ![トークンのコピー](images/copy-token.png)
    
    > 次のタスクでは、この認証トークンを**シークレット**に格納します。
    

## タスク2: ボールトでのシークレットの作成

シークレットとは、パスワード、証明書、SSHキー、Oracle Cloud Infrastructureサービスで使用する**認証トークン**などの資格証明です。

1.  OCIコンソールで、**「ハンバーガー・メニュー」**→**「アイデンティティとセキュリティ」**→**「Vault」**をクリックします。 ![メニュー・ボールト](images/menu-vault.png)
    
2.  **「リスト範囲」**の下のコンパートメントを選択し、**「Vaultの作成」**をクリックします。
    
3.  Vaultの名前を入力し、**「Vaultの作成」**をクリックします。 ![ボールトの作成](images/create-vault.png)
    
4.  作成したVaultが**「アクティブ」**状態になったら、次に示すようにVault名をクリックします。 ![ボールト名](images/vault-name.png)
    
5.  ボールト内で、**「マスター暗号化キー」**、**「キーの作成」**の順にクリックします。 ![メニュー](images/menu-mek.png)
    
6.  **キー**の名前を入力し、次に示すように**「キーの作成」**をクリックします。 ![mekの作成](images/create-mek.png)
    
7.  新しいマスター暗号化キーの状態が**「有効」**に変更されたら、次に示すように**「リソース」**の下の**「シークレット」**をクリックします。 ![メニュー・シークレット](images/menu-secret.png)
    
8.  **「シークレットの作成」**をクリックします。
    
9.  「シークレット」の名前を入力し、新しい暗号化キーを選択し、次に示すように**「シークレット・コンテンツ」**として認証トークンを入力します。**「シークレットの作成」**をクリックします。 ![シークレットの作成](images/create-secret.png)
    

## タスク3: スタックの作成: Oracle WebLogic Suite for OKE BYOL

1.  OCIコンソールで、**「ハンバーガー・メニュー」**→**「マーケットプレイス」**→**「すべてのアプリケーション」**をクリックします。 ![メニュー・マーケットプレイス](images/menu-marketplace.png)
    
2.  検索ボックスに**WebLogic OKE**と入力し、**「Oracle WebLogic Suite for OKE BYOL」**をクリックします。 ![メニュー・スタック](images/menu-stack.png)
    
3.  使用可能な最新バージョンを選択し、コンパートメントを選択して、条件を受け入れるボックスを選択します。**「スタックの起動」**をクリックします。 ![スタックの起動](images/launch-stack.png)
    
4.  「スタック情報」セクションで、すべてをデフォルトのままにして**「次へ」**をクリックします。 ![スタック情報](images/stack-info.png)
    
5.  「リソース名接頭辞」として**wko**と入力し、「参照」をクリックしてSSH公開キーを選択します。 ![プリフィクス-ssh](images/prefix-ssh.png)
    
    > これについては以降の演習で使用するため、必ず接頭辞として**wko**を使用してください。
    
6.  Verrazzano統合では、**「Verrazzanoの有効化」**のデフォルトのチェック・ボックスの選択を解除したままにします。 ![verrazzanoのチェックを外す](images/uncheck-verrazzano.png)
    
7.  「ネットワーク」で、「Virtual Cloudネットワーク戦略」として**「新規VCNの作成」**を選択し、すべてをデフォルトのままにします。 ![ネットワーク](images/network.png)
    
8.  「コンテナクラスタ(OKE)構成」で、次を選択します。
    
    **Kubernetesバージョン:** - デフォルトの**v1.26.2**のままにします。
    
    **非WebLogicノード・プール・シェイプ(必須)** - **VM.Standard.E4を選択します。シェイプとしてフレックス**を行い、OCPUの数として**1**を選択し、メモリーの量として**16**を選択します。
    
    **WebLogic以外のポッドのNodePool内のノード** - デフォルトの**1**のままにします。
    
    ![非論理](images/non-weblogic.png)
    
    **WebLogicノード・プール・シェイプの作成** - デフォルトのボックスを選択したままにします。
    
    **WebLogicノード・プール・シェイプ(必須)** - **VM.Standard.E4を選択します。シェイプとしてフレックス**を行い、OCPUの数として**1**を選択し、メモリーの量として**16**を選択します。
    
    **WebLogicポッドのNodePool内のノード** - デフォルトの**1**のままにします。
    
    ![論理学](images/weblogic-pool.png)
    
9.  「管理インスタンス」で、次のように入力するか選択します。**コンピュート・インスタンスの可用性ドメイン** - ドロップダウンから可用性ドメインを選択します。
    
    **管理インスタンスのコンピュート・シェイプ(必須)** - **VM.Standard.E4を選択します。シェイプとしてフレックス**を行い、OCPUの数として**1**を選択し、メモリーの量として**16**を選択します。
    
    ![管理インスタンス](images/admin-instance.png)
    
    **要塞インスタンス・シェイプ(必須)** - **VM.Standard.E4を選択します。シェイプとしてフレックス**を行い、OCPUの数として**1**を選択し、メモリーの量として**16**を選択します。
    
    ![要塞](images/bastion.png)
    
10.  「ファイル・システム」セクションで、次に示すように選択します。**ファイル・システムの可用性ドメイン** - ドロップダウンから可用性ドメインを選択します。 ![平均ファイル](images/file-avd.png)
    
11.  「レジストリ(OCIR)」セクションで、次のように入力します。
    
    **レジストリ・ユーザー名** - Kubernetesがコンテナ・イメージ・レジストリへのアクセスに使用するユーザー名({identity domain name}/{username})の形式です。テナンシでOracle Identity Cloud Serviceを使用している場合は、oracleidentitycloudservice/{username}の形式を使用します。
    
    **OCIR認証トークン・コンパートメント** - OCIR認証トークンがあるコンパートメントを選択します。
    
    **OCIR認証トークンの検証済シークレット** - ユーザーがイメージ・レジストリにアクセスするために生成したOCIR認証トークンを含むシークレット。
    
    ![ocirの秘密](images/ocir-secret.png)
    
12.  「OCIポリシー」で、**「OCIポリシー」**のボックスを選択します。Vaultからシークレットを読み取り、Autonomous Transaction Processingデータベースを管理するためのポリシーを作成します(該当する場合)。**「次へ」**をクリックします。
    
13.  「確認」セクションで、**「適用の実行」**ボックスを選択し、**「作成」**をクリックします。 ![適用の実行](images/run-apply.png)
    
    > これによりジョブが作成され、スタックに必要なリソースが作成されます。待つ必要はありません。次のタスクに進んでください。
    

## タスク4: グラフィカルリモートデスクトップへのアクセス

このワークショップを簡単に実行できるように、VMインスタンスは、ラップトップまたはワークステーション上の最新のブラウザを使用してアクセス可能なリモートのグラフィカル・デスクトップで事前構成されています。次の詳細に従ってログインしてください。

1.  左上隅のハンバーガーメニューを開きます。**「開発者サービス」**をクリックし、**「リソース・マネージャ」**→**「スタック」**を選択します。
    
2.  演習1で作成したスタック名をクリックします。 ![スタックをクリック](images/click-stack.png)
    
3.  **「アプリケーション情報」**タブにナビゲートし、**リモート・デスクトップURL**をコピーして新しいブラウザ・タブに貼り付けます。 ![デスクトップURL](images/desktop-url.png)
    
    > これで、このリモートデスクトップ内のすべての指示に従う必要があります。
    

次の演習に進むことができます。

## 確認

*   **著者** - Ankit Pandey
*   **貢献者** - Sid Joshi、Maciej Gruszka
*   **最終更新者/日付** - Ankit Pandey、2023年10月